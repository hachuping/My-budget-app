<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤ë§ˆíŠ¸ ê°€ê³„ë¶€</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Noto Sans KR', sans-serif; }
        .page { display: none; }
        .page.active { display: block; }
        .nav-item.active { background-color: #3b82f6; color: white; }
        .chart-container { position: relative; height: 300px; }
        .chart-bar { transition: all 0.3s ease; }
        .chart-bar:hover { opacity: 0.8; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
    <nav class="bg-white shadow-lg border-b">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <h1 class="text-2xl font-bold text-gray-800">ğŸ’° ìŠ¤ë§ˆíŠ¸ ê°€ê³„ë¶€</h1>
                <div class="flex space-x-2">
                    <button onclick="showPage('entry')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors bg-blue-500 text-white">ë‚´ì—­ ì…ë ¥</button>
                    <button onclick="showPage('monthly')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-100">ì›”ë³„ ì •ë¦¬</button>
                    <button onclick="showPage('yearly')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-100">ì—°ë„ë³„ ì •ë¦¬</button>
                    <button onclick="showPage('assets')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-100">ìì‚° ê´€ë¦¬</button>
                    <button onclick="showPage('settings')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-100">ì„¤ì •</button>
                    <button onclick="showPage('share')" class="nav-item px-4 py-2 rounded-lg text-sm font-medium transition-colors text-gray-600 hover:bg-gray-100">ê³µìœ </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- í˜ì´ì§€ 1: ë‚´ì—­ ì…ë ¥ -->
    <div id="entry" class="page active">
        <div class="max-w-4xl mx-auto p-6">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-semibold mb-6 text-gray-800">ğŸ’³ ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­ ì…ë ¥</h2>
                
                <form id="entryForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ë‚ ì§œ</label>
                        <input type="date" id="entryDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ìœ í˜•</label>
                        <select id="entryType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" onchange="updateCategories()" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="income">ìˆ˜ì…</option>
                            <option value="savings">ì €ì¶•</option>
                            <option value="expense">ì§€ì¶œ</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                        <select id="entryCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">ìœ í˜•ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê¸ˆì•¡ (ì›)</label>
                        <input type="number" id="entryAmount" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0" required>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ë©”ëª¨</label>
                        <input type="text" id="entryMemo" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ì„ íƒì‚¬í•­">
                    </div>
                    
                    <div class="md:col-span-2">
                        <button type="submit" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors">
                            âœ… ë‚´ì—­ ì¶”ê°€
                        </button>
                    </div>
                </form>
            </div>

            <!-- ìµœê·¼ ë‚´ì—­ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ“‹ ìµœê·¼ ë‚´ì—­</h3>
                <div id="recentEntries" class="space-y-3">
                    <!-- ìµœê·¼ ë‚´ì—­ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ 2: ì›”ë³„ ì •ë¦¬ -->
    <div id="monthly" class="page">
        <div class="max-w-6xl mx-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800">ğŸ“Š ì›”ë³„ ê°€ê³„ë¶€</h2>
                <div class="flex items-center space-x-4">
                    <select id="monthlyYear" class="px-3 py-2 border border-gray-300 rounded-lg" onchange="updateMonthlyView()">
                        <!-- ì—°ë„ ì˜µì…˜ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                    </select>
                    <select id="monthlyMonth" class="px-3 py-2 border border-gray-300 rounded-lg" onchange="updateMonthlyView()">
                        <option value="1">1ì›”</option>
                        <option value="2">2ì›”</option>
                        <option value="3">3ì›”</option>
                        <option value="4">4ì›”</option>
                        <option value="5">5ì›”</option>
                        <option value="6">6ì›”</option>
                        <option value="7">7ì›”</option>
                        <option value="8">8ì›”</option>
                        <option value="9">9ì›”</option>
                        <option value="10">10ì›”</option>
                        <option value="11">11ì›”</option>
                        <option value="12">12ì›”</option>
                    </select>
                </div>
            </div>

            <!-- ì›”ë³„ ìš”ì•½ -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-600 text-sm font-medium">ì´ ìˆ˜ì…</p>
                            <p id="monthlyIncome" class="text-2xl font-bold text-green-700">0ì›</p>
                        </div>
                        <div class="text-green-500 text-3xl">ğŸ’°</div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-600 text-sm font-medium">ì´ ì €ì¶•</p>
                            <p id="monthlySavings" class="text-2xl font-bold text-blue-700">0ì›</p>
                        </div>
                        <div class="text-blue-500 text-3xl">ğŸ¦</div>
                    </div>
                </div>
                
                <div class="bg-red-50 border border-red-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-600 text-sm font-medium">ì´ ì§€ì¶œ</p>
                            <p id="monthlyExpense" class="text-2xl font-bold text-red-700">0ì›</p>
                        </div>
                        <div class="text-red-500 text-3xl">ğŸ’¸</div>
                    </div>
                </div>
                
                <div class="bg-purple-50 border border-purple-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-600 text-sm font-medium">ìˆœ ìì‚° ë³€í™”</p>
                            <p id="monthlyNet" class="text-2xl font-bold text-purple-700">0ì›</p>
                        </div>
                        <div class="text-purple-500 text-3xl">ğŸ“ˆ</div>
                    </div>
                </div>
            </div>

            <!-- ì˜ˆì‚° ëŒ€ë¹„ í˜„í™© -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ¯ ì˜ˆì‚° ë‹¬ì„± í˜„í™©</h3>
                <div id="budgetProgress" class="space-y-4">
                    <!-- ì˜ˆì‚° ì§„í–‰ë¥ ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸ -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-green-700">ğŸ’° ìˆ˜ì… ë‚´ì—­</h3>
                    <div id="monthlyIncomeDetails" class="space-y-2">
                        <!-- ìˆ˜ì… ìƒì„¸ ë‚´ì—­ -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">ğŸ¦ ì €ì¶• ë‚´ì—­</h3>
                    <div id="monthlySavingsDetails" class="space-y-2">
                        <!-- ì €ì¶• ìƒì„¸ ë‚´ì—­ -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-red-700">ğŸ’¸ ì§€ì¶œ ë‚´ì—­</h3>
                    <div id="monthlyExpenseDetails" class="space-y-2">
                        <!-- ì§€ì¶œ ìƒì„¸ ë‚´ì—­ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ 3: ì—°ë„ë³„ ì •ë¦¬ -->
    <div id="yearly" class="page">
        <div class="max-w-6xl mx-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800">ğŸ“ˆ ì—°ë„ë³„ ê°€ê³„ë¶€</h2>
                <select id="yearlyYear" class="px-3 py-2 border border-gray-300 rounded-lg" onchange="updateYearlyView()">
                    <!-- ì—°ë„ ì˜µì…˜ì´ ë™ì ìœ¼ë¡œ ì¶”ê°€ë©ë‹ˆë‹¤ -->
                </select>
            </div>

            <!-- ì—°ë„ë³„ ìš”ì•½ -->
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-6">
                <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-600 text-sm font-medium">ì—°ê°„ ì´ ìˆ˜ì…</p>
                            <p id="yearlyIncome" class="text-2xl font-bold text-green-700">0ì›</p>
                        </div>
                        <div class="text-green-500 text-3xl">ğŸ’°</div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-600 text-sm font-medium">ì—°ê°„ ì´ ì €ì¶•</p>
                            <p id="yearlySavings" class="text-2xl font-bold text-blue-700">0ì›</p>
                        </div>
                        <div class="text-blue-500 text-3xl">ğŸ¦</div>
                    </div>
                </div>
                
                <div class="bg-red-50 border border-red-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-600 text-sm font-medium">ì—°ê°„ ì´ ì§€ì¶œ</p>
                            <p id="yearlyExpense" class="text-2xl font-bold text-red-700">0ì›</p>
                        </div>
                        <div class="text-red-500 text-3xl">ğŸ’¸</div>
                    </div>
                </div>
                
                <div class="bg-purple-50 border border-purple-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-purple-600 text-sm font-medium">ì—°ê°„ ìˆœ ìì‚° ë³€í™”</p>
                            <p id="yearlyNet" class="text-2xl font-bold text-purple-700">0ì›</p>
                        </div>
                        <div class="text-purple-500 text-3xl">ğŸ“Š</div>
                    </div>
                </div>
            </div>

            <!-- ì›”ë³„ ì°¨íŠ¸ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ“Š ì›”ë³„ ì¶”ì´</h3>
                <div class="chart-container">
                    <canvas id="yearlyChart" class="w-full h-full"></canvas>
                </div>
            </div>

            <!-- ì¹´í…Œê³ ë¦¬ë³„ ì—°ê°„ í†µê³„ -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-green-700">ğŸ’° ì—°ê°„ ìˆ˜ì… ë¶„ì„</h3>
                    <div id="yearlyIncomeAnalysis" class="space-y-3">
                        <!-- ì—°ê°„ ìˆ˜ì… ë¶„ì„ -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">ğŸ¦ ì—°ê°„ ì €ì¶• ë¶„ì„</h3>
                    <div id="yearlySavingsAnalysis" class="space-y-3">
                        <!-- ì—°ê°„ ì €ì¶• ë¶„ì„ -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-red-700">ğŸ’¸ ì—°ê°„ ì§€ì¶œ ë¶„ì„</h3>
                    <div id="yearlyExpenseAnalysis" class="space-y-3">
                        <!-- ì—°ê°„ ì§€ì¶œ ë¶„ì„ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ 4: ìì‚° ê´€ë¦¬ -->
    <div id="assets" class="page">
        <div class="max-w-6xl mx-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-semibold text-gray-800">ğŸ  ìì‚° ê´€ë¦¬</h2>
                <button onclick="showAssetForm()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                    â• ìì‚° ì¶”ê°€
                </button>
            </div>

            <!-- ìì‚° ìš”ì•½ -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                <div class="bg-green-50 border border-green-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-green-600 text-sm font-medium">ì´ ìì‚°</p>
                            <p id="totalAssets" class="text-2xl font-bold text-green-700">0ì›</p>
                        </div>
                        <div class="text-green-500 text-3xl">ğŸ’</div>
                    </div>
                </div>
                
                <div class="bg-red-50 border border-red-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-red-600 text-sm font-medium">ì´ ë¶€ì±„</p>
                            <p id="totalLiabilities" class="text-2xl font-bold text-red-700">0ì›</p>
                        </div>
                        <div class="text-red-500 text-3xl">ğŸ“‰</div>
                    </div>
                </div>
                
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-blue-600 text-sm font-medium">ìˆœ ìì‚°</p>
                            <p id="netWorth" class="text-2xl font-bold text-blue-700">0ì›</p>
                        </div>
                        <div class="text-blue-500 text-3xl">ğŸ’°</div>
                    </div>
                </div>
            </div>

            <!-- ìì‚° ì…ë ¥ í¼ (ìˆ¨ê¹€) -->
            <div id="assetForm" class="bg-white rounded-xl shadow-lg p-6 mb-6" style="display: none;">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ìì‚°/ë¶€ì±„ ì¶”ê°€</h3>
                <form id="assetEntryForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ìœ í˜•</label>
                        <select id="assetType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                            <option value="asset">ìì‚°</option>
                            <option value="liability">ë¶€ì±„</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ì¹´í…Œê³ ë¦¬</label>
                        <select id="assetCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                            <option value="">ìœ í˜•ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">í•­ëª©ëª…</label>
                        <input type="text" id="assetName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ì˜ˆ: ì‹ í•œì€í–‰ ì ê¸ˆ" required>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê¸ˆì•¡ (ì›)</label>
                        <input type="number" id="assetAmount" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="0" required>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium text-gray-700 mb-2">ë©”ëª¨</label>
                        <input type="text" id="assetMemo" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="ì„ íƒì‚¬í•­">
                    </div>
                    
                    <div class="md:col-span-2 flex space-x-3">
                        <button type="submit" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded-lg transition-colors">
                            âœ… ì¶”ê°€
                        </button>
                        <button type="button" onclick="hideAssetForm()" class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors">
                            ì·¨ì†Œ
                        </button>
                    </div>
                </form>
            </div>

            <!-- ìì‚° ëª©ë¡ -->
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-green-700">ğŸ’ ìì‚° ëª©ë¡</h3>
                    <div id="assetsList" class="space-y-3">
                        <!-- ìì‚° ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-red-700">ğŸ“‰ ë¶€ì±„ ëª©ë¡</h3>
                    <div id="liabilitiesList" class="space-y-3">
                        <!-- ë¶€ì±„ ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ 5: ê³µìœ  -->
    <div id="share" class="page">
        <div class="max-w-4xl mx-auto p-6">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">ğŸ¤ ê°€ê³„ë¶€ ê³µìœ </h2>

            <!-- ê³µìœ  ìƒíƒœ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ“Š í˜„ì¬ ê³µìœ  ìƒíƒœ</h3>
                <div id="shareStatus" class="space-y-3">
                    <!-- ê³µìœ  ìƒíƒœê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>

            <!-- ê³µìœ  ë§í¬ ìƒì„± -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ”— ê³µìœ  ë§í¬ ìƒì„±</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ  ìœ í˜•</label>
                        <select id="shareType" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="view">ë³´ê¸° ì „ìš© (ì½ê¸°ë§Œ ê°€ëŠ¥)</option>
                            <option value="edit">í¸ì§‘ ê°€ëŠ¥ (ìˆ˜ì • ê°€ëŠ¥)</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ í•  ë°ì´í„° ì„ íƒ</label>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" id="shareEntries" class="mr-2" checked>
                                <span class="text-sm">ìˆ˜ì…/ì§€ì¶œ ë‚´ì—­</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="shareAssets" class="mr-2" checked>
                                <span class="text-sm">ìì‚° ì •ë³´</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" id="shareBudgets" class="mr-2" checked>
                                <span class="text-sm">ì˜ˆì‚° ëª©í‘œ</span>
                            </label>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ  ê¸°ê°„ (ì„ íƒì‚¬í•­)</label>
                        <select id="shareExpiry" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="">ë¬´ì œí•œ</option>
                            <option value="1">1ì¼</option>
                            <option value="7">7ì¼</option>
                            <option value="30">30ì¼</option>
                            <option value="90">90ì¼</option>
                        </select>
                    </div>
                    
                    <button onclick="generateShareLink()" class="w-full bg-blue-500 hover:bg-blue-600 text-white font-medium py-3 px-4 rounded-lg transition-colors">
                        ğŸ”— ê³µìœ  ë§í¬ ìƒì„±
                    </button>
                </div>
            </div>

            <!-- ìƒì„±ëœ ê³µìœ  ë§í¬ -->
            <div id="generatedLink" class="bg-white rounded-xl shadow-lg p-6 mb-6" style="display: none;">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">âœ… ê³µìœ  ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!</h3>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ  ë§í¬</label>
                        <div class="flex space-x-2">
                            <input type="text" id="shareUrl" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50" readonly>
                            <button onclick="copyShareLink()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                                ğŸ“‹ ë³µì‚¬
                            </button>
                        </div>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ  ì½”ë“œ</label>
                        <div class="flex space-x-2">
                            <input type="text" id="shareCode" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg bg-gray-50 text-center text-lg font-mono" readonly>
                            <button onclick="copyShareCode()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                                ğŸ“‹ ë³µì‚¬
                            </button>
                        </div>
                        <p class="text-xs text-gray-500 mt-1">ìƒëŒ€ë°©ì´ ì´ ì½”ë“œë¥¼ ì…ë ¥í•˜ì—¬ ê°€ê³„ë¶€ì— ì ‘ê·¼í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    </div>
                </div>
            </div>

            <!-- ê³µìœ  ì½”ë“œë¡œ ì ‘ì† -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ”‘ ê³µìœ  ì½”ë“œë¡œ ì ‘ì†</h3>
                <div class="space-y-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê³µìœ  ì½”ë“œ ì…ë ¥</label>
                        <div class="flex space-x-2">
                            <input type="text" id="inputShareCode" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-center text-lg font-mono" placeholder="ì˜ˆ: ABC123">
                            <button onclick="connectWithCode()" class="bg-purple-500 hover:bg-purple-600 text-white px-4 py-2 rounded-lg transition-colors">
                                ğŸ”— ì—°ê²°
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- í™œì„± ê³µìœ  ëª©ë¡ -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ“‹ í™œì„± ê³µìœ  ëª©ë¡</h3>
                <div id="activeShares" class="space-y-3">
                    <!-- í™œì„± ê³µìœ  ëª©ë¡ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
            </div>
        </div>
    </div>

    <!-- í˜ì´ì§€ 6: ì„¤ì • -->
    <div id="settings" class="page">
        <div class="max-w-4xl mx-auto p-6">
            <h2 class="text-2xl font-semibold mb-6 text-gray-800">âš™ï¸ ê°€ê³„ë¶€ ì„¤ì •</h2>

            <!-- ê¸°ë³¸ ì„¤ì • -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ“… ê¸°ë³¸ ì„¤ì •</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê°€ê³„ë¶€ ì‹œì‘ì¼</label>
                        <input type="date" id="startDate" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">ê¸°ë³¸ í†µí™”</label>
                        <select id="currency" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                            <option value="KRW">ì› (KRW)</option>
                            <option value="USD">ë‹¬ëŸ¬ (USD)</option>
                            <option value="EUR">ìœ ë¡œ (EUR)</option>
                        </select>
                    </div>
                </div>
                <button onclick="saveBasicSettings()" class="mt-4 bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                    ğŸ’¾ ì €ì¥
                </button>
            </div>

            <!-- ì˜ˆì‚° ì„¤ì • -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ¯ ì›”ë³„ ì˜ˆì‚° ëª©í‘œ</h3>
                <div id="budgetSettings" class="space-y-4">
                    <!-- ì˜ˆì‚° ì„¤ì •ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
                </div>
                <button onclick="addBudgetGoal()" class="mt-4 bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                    â• ì˜ˆì‚° ëª©í‘œ ì¶”ê°€
                </button>
            </div>

            <!-- ì¹´í…Œê³ ë¦¬ ê´€ë¦¬ -->
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-green-700">ğŸ’° ìˆ˜ì… ì¹´í…Œê³ ë¦¬</h3>
                    <div id="incomeCategories" class="space-y-2 mb-4">
                        <!-- ìˆ˜ì… ì¹´í…Œê³ ë¦¬ ëª©ë¡ -->
                    </div>
                    <div class="flex space-x-2">
                        <input type="text" id="newIncomeCategory" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="ìƒˆ ì¹´í…Œê³ ë¦¬">
                        <button onclick="addCategory('income')" class="bg-green-500 hover:bg-green-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">ì¶”ê°€</button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-blue-700">ğŸ¦ ì €ì¶• ì¹´í…Œê³ ë¦¬</h3>
                    <div id="savingsCategories" class="space-y-2 mb-4">
                        <!-- ì €ì¶• ì¹´í…Œê³ ë¦¬ ëª©ë¡ -->
                    </div>
                    <div class="flex space-x-2">
                        <input type="text" id="newSavingsCategory" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="ìƒˆ ì¹´í…Œê³ ë¦¬">
                        <button onclick="addCategory('savings')" class="bg-blue-500 hover:bg-blue-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">ì¶”ê°€</button>
                    </div>
                </div>
                
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-lg font-semibold mb-4 text-red-700">ğŸ’¸ ì§€ì¶œ ì¹´í…Œê³ ë¦¬</h3>
                    <div id="expenseCategories" class="space-y-2 mb-4">
                        <!-- ì§€ì¶œ ì¹´í…Œê³ ë¦¬ ëª©ë¡ -->
                    </div>
                    <div class="flex space-x-2">
                        <input type="text" id="newExpenseCategory" class="flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm" placeholder="ìƒˆ ì¹´í…Œê³ ë¦¬">
                        <button onclick="addCategory('expense')" class="bg-red-500 hover:bg-red-600 text-white px-3 py-2 rounded-lg text-sm transition-colors">ì¶”ê°€</button>
                    </div>
                </div>
            </div>

            <!-- ë°ì´í„° ê´€ë¦¬ -->
            <div class="bg-white rounded-xl shadow-lg p-6 mt-6">
                <h3 class="text-lg font-semibold mb-4 text-gray-800">ğŸ’¾ ë°ì´í„° ê´€ë¦¬</h3>
                <div class="flex flex-wrap gap-4">
                    <button onclick="exportData()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ğŸ“¤ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
                    </button>
                    <button onclick="importData()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ğŸ“¥ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    </button>
                    <button onclick="resetData()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-lg transition-colors">
                        ğŸ—‘ï¸ ëª¨ë“  ë°ì´í„° ì´ˆê¸°í™”
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜
        let entries = JSON.parse(localStorage.getItem('entries') || '[]');
        let assets = JSON.parse(localStorage.getItem('assets') || '[]');
        let categories = JSON.parse(localStorage.getItem('categories') || JSON.stringify({
            income: ['ê¸‰ì—¬', 'ë¶€ì—…', 'íˆ¬ììˆ˜ìµ', 'ê¸°íƒ€ìˆ˜ì…'],
            savings: ['ì ê¸ˆ', 'ì˜ˆê¸ˆ', 'íˆ¬ì', 'ì—°ê¸ˆ'],
            expense: ['ì‹ë¹„', 'êµí†µë¹„', 'ì£¼ê±°ë¹„', 'ì˜ë£Œë¹„', 'ì‡¼í•‘', 'ë¬¸í™”ìƒí™œ', 'ê¸°íƒ€ì§€ì¶œ']
        }));
        let budgetGoals = JSON.parse(localStorage.getItem('budgetGoals') || '{}');
        let settings = JSON.parse(localStorage.getItem('settings') || JSON.stringify({
            startDate: new Date().toISOString().split('T')[0],
            currency: 'KRW'
        }));
        let shareData = JSON.parse(localStorage.getItem('shareData') || '{}');
        let activeShares = JSON.parse(localStorage.getItem('activeShares') || '[]');
        let connectedShares = JSON.parse(localStorage.getItem('connectedShares') || '[]');

        // ìì‚° ì¹´í…Œê³ ë¦¬
        const assetCategories = {
            asset: ['í˜„ê¸ˆ', 'ì˜ˆê¸ˆ', 'ì ê¸ˆ', 'ì£¼ì‹', 'ë¶€ë™ì‚°', 'ê¸°íƒ€ìì‚°'],
            liability: ['ì‹ ìš©ì¹´ë“œ', 'ëŒ€ì¶œ', 'ê¸°íƒ€ë¶€ì±„']
        };

        // í˜ì´ì§€ ì „í™˜
        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            
            document.getElementById(pageId).classList.add('active');
            event.target.classList.add('active');
            
            // í˜ì´ì§€ë³„ ì´ˆê¸°í™”
            if (pageId === 'monthly') {
                initMonthlyView();
            } else if (pageId === 'yearly') {
                initYearlyView();
            } else if (pageId === 'assets') {
                updateAssetsView();
            } else if (pageId === 'settings') {
                initSettingsView();
            } else if (pageId === 'entry') {
                updateRecentEntries();
            } else if (pageId === 'share') {
                initShareView();
            }
        }

        // ì´ˆê¸°í™”
        function init() {
            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
            
            // í¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('entryForm').addEventListener('submit', addEntry);
            document.getElementById('assetEntryForm').addEventListener('submit', addAsset);
            
            // ì´ˆê¸° ë·° ì—…ë°ì´íŠ¸
            updateRecentEntries();
            initMonthlyView();
            initYearlyView();
            updateAssetsView();
            initSettingsView();
        }

        // ì¹´í…Œê³ ë¦¬ ì—…ë°ì´íŠ¸
        function updateCategories() {
            const type = document.getElementById('entryType').value;
            const categorySelect = document.getElementById('entryCategory');
            
            categorySelect.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>';
            
            if (type && categories[type]) {
                categories[type].forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }
        }

        // ë‚´ì—­ ì¶”ê°€
        function addEntry(e) {
            e.preventDefault();
            
            const entry = {
                id: Date.now(),
                date: document.getElementById('entryDate').value,
                type: document.getElementById('entryType').value,
                category: document.getElementById('entryCategory').value,
                amount: parseInt(document.getElementById('entryAmount').value),
                memo: document.getElementById('entryMemo').value
            };
            
            entries.unshift(entry);
            localStorage.setItem('entries', JSON.stringify(entries));
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('entryForm').reset();
            document.getElementById('entryDate').value = new Date().toISOString().split('T')[0];
            document.getElementById('entryCategory').innerHTML = '<option value="">ìœ í˜•ì„ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”</option>';
            
            updateRecentEntries();
            
            // ì„±ê³µ ë©”ì‹œì§€
            alert('ë‚´ì—­ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’°');
        }

        // ìµœê·¼ ë‚´ì—­ ì—…ë°ì´íŠ¸
        function updateRecentEntries() {
            const container = document.getElementById('recentEntries');
            const recentEntries = entries.slice(0, 10);
            
            if (recentEntries.length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center py-4">ì•„ì§ ì…ë ¥ëœ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            container.innerHTML = recentEntries.map(entry => {
                const typeColors = {
                    income: 'text-green-600 bg-green-50',
                    savings: 'text-blue-600 bg-blue-50',
                    expense: 'text-red-600 bg-red-50'
                };
                
                const typeNames = {
                    income: 'ìˆ˜ì…',
                    savings: 'ì €ì¶•',
                    expense: 'ì§€ì¶œ'
                };
                
                return `
                    <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2">
                                <span class="px-2 py-1 text-xs font-medium rounded-full ${typeColors[entry.type]}">
                                    ${typeNames[entry.type]}
                                </span>
                                <span class="text-sm font-medium text-gray-800">${entry.category}</span>
                            </div>
                            <p class="text-sm text-gray-600 mt-1">${entry.memo || 'ë©”ëª¨ ì—†ìŒ'}</p>
                        </div>
                        <div class="text-right">
                            <p class="font-semibold ${entry.type === 'income' ? 'text-green-600' : entry.type === 'savings' ? 'text-blue-600' : 'text-red-600'}">
                                ${entry.amount.toLocaleString()}ì›
                            </p>
                            <p class="text-xs text-gray-500">${entry.date}</p>
                        </div>
                        <button onclick="deleteEntry(${entry.id})" class="ml-3 text-red-500 hover:text-red-700 transition-colors">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `;
            }).join('');
        }

        // ë‚´ì—­ ì‚­ì œ
        function deleteEntry(id) {
            if (confirm('ì´ ë‚´ì—­ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                entries = entries.filter(entry => entry.id !== id);
                localStorage.setItem('entries', JSON.stringify(entries));
                updateRecentEntries();
            }
        }

        // ì›”ë³„ ë·° ì´ˆê¸°í™”
        function initMonthlyView() {
            const yearSelect = document.getElementById('monthlyYear');
            const monthSelect = document.getElementById('monthlyMonth');
            
            // ì—°ë„ ì˜µì…˜ ìƒì„±
            const currentYear = new Date().getFullYear();
            const years = [...new Set(entries.map(entry => new Date(entry.date).getFullYear()))];
            if (years.length === 0) years.push(currentYear);
            
            yearSelect.innerHTML = years.sort((a, b) => b - a).map(year => 
                `<option value="${year}" ${year === currentYear ? 'selected' : ''}>${year}ë…„</option>`
            ).join('');
            
            // í˜„ì¬ ì›” ì„ íƒ
            monthSelect.value = new Date().getMonth() + 1;
            
            updateMonthlyView();
        }

        // ì›”ë³„ ë·° ì—…ë°ì´íŠ¸
        function updateMonthlyView() {
            const year = parseInt(document.getElementById('monthlyYear').value);
            const month = parseInt(document.getElementById('monthlyMonth').value);
            
            const monthlyEntries = entries.filter(entry => {
                const entryDate = new Date(entry.date);
                return entryDate.getFullYear() === year && entryDate.getMonth() + 1 === month;
            });
            
            // ì›”ë³„ ìš”ì•½ ê³„ì‚°
            const summary = {
                income: monthlyEntries.filter(e => e.type === 'income').reduce((sum, e) => sum + e.amount, 0),
                savings: monthlyEntries.filter(e => e.type === 'savings').reduce((sum, e) => sum + e.amount, 0),
                expense: monthlyEntries.filter(e => e.type === 'expense').reduce((sum, e) => sum + e.amount, 0)
            };
            
            summary.net = summary.income - summary.savings - summary.expense;
            
            // ìš”ì•½ í‘œì‹œ
            document.getElementById('monthlyIncome').textContent = summary.income.toLocaleString() + 'ì›';
            document.getElementById('monthlySavings').textContent = summary.savings.toLocaleString() + 'ì›';
            document.getElementById('monthlyExpense').textContent = summary.expense.toLocaleString() + 'ì›';
            document.getElementById('monthlyNet').textContent = summary.net.toLocaleString() + 'ì›';
            
            // ì˜ˆì‚° ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
            updateBudgetProgress(year, month, summary);
            
            // ì¹´í…Œê³ ë¦¬ë³„ ìƒì„¸ ì—…ë°ì´íŠ¸
            updateMonthlyCategoryDetails(monthlyEntries);
        }

        // ì˜ˆì‚° ì§„í–‰ë¥  ì—…ë°ì´íŠ¸
        function updateBudgetProgress(year, month, summary) {
            const container = document.getElementById('budgetProgress');
            const monthKey = `${year}-${month.toString().padStart(2, '0')}`;
            
            if (!budgetGoals[monthKey] || Object.keys(budgetGoals[monthKey]).length === 0) {
                container.innerHTML = '<p class="text-gray-500 text-center">ì„¤ì •ëœ ì˜ˆì‚° ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤. ì„¤ì • í˜ì´ì§€ì—ì„œ ì˜ˆì‚°ì„ ì„¤ì •í•´ë³´ì„¸ìš”.</p>';
                return;
            }
            
            const goals = budgetGoals[monthKey];
            let html = '';
            
            Object.entries(goals).forEach(([type, goal]) => {
                const actual = summary[type] || 0;
                const percentage = goal > 0 ? Math.min((actual / goal) * 100, 100) : 0;
                const isOver = actual > goal;
                
                const typeNames = {
                    income: 'ìˆ˜ì…',
                    savings: 'ì €ì¶•',
                    expense: 'ì§€ì¶œ'
                };
                
                const colors = {
                    income: isOver ? 'bg-green-500' : 'bg-green-300',
                    savings: isOver ? 'bg-blue-500' : 'bg-blue-300',
                    expense: isOver ? 'bg-red-500' : 'bg-red-300'
                };
                
                html += `
                    <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <span class="text-sm font-medium">${typeNames[type]} ëª©í‘œ</span>
                            <span class="text-sm ${isOver ? 'text-red-600' : 'text-gray-600'}">
                                ${actual.toLocaleString()}ì› / ${goal.toLocaleString()}ì›
                            </span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-2">
                            <div class="${colors[type]} h-2 rounded-full transition-all duration-300" style="width: ${percentage}%"></div>
                        </div>
                        <div class="text-xs text-gray-500">
                            ${percentage.toFixed(1)}% ë‹¬ì„± ${isOver ? '(ëª©í‘œ ì´ˆê³¼)' : ''}
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        // ì›”ë³„ ì¹´í…Œê³ ë¦¬ ìƒì„¸ ì—…ë°ì´íŠ¸
        function updateMonthlyCategoryDetails(monthlyEntries) {
            const types = ['income', 'savings', 'expense'];
            
            types.forEach(type => {
                const container = document.getElementById(`monthly${type.charAt(0).toUpperCase() + type.slice(1)}Details`);
                const typeEntries = monthlyEntries.filter(e => e.type === type);
                
                if (typeEntries.length === 0) {
                    container.innerHTML = '<p class="text-gray-500 text-sm">ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }
                
                // ì¹´í…Œê³ ë¦¬ë³„ í•©ê³„ ê³„ì‚°
                const categoryTotals = {};
                typeEntries.forEach(entry => {
                    categoryTotals[entry.category] = (categoryTotals[entry.category] || 0) + entry.amount;
                });
                
                // ì •ë ¬ (ê¸ˆì•¡ ìˆœ)
                const sortedCategories = Object.entries(categoryTotals)
                    .sort(([,a], [,b]) => b - a);
                
                container.innerHTML = sortedCategories.map(([category, amount]) => `
                    <div class="flex justify-between items-center py-2 border-b border-gray-100 last:border-b-0">
                        <span class="text-sm text-gray-700">${category}</span>
                        <span class="text-sm font-medium">${amount.toLocaleString()}ì›</span>
                    </div>
                `).join('');
            });
        }

        // ì—°ë„ë³„ ë·° ì´ˆê¸°í™”
        function initYearlyView() {
            const yearSelect = document.getElementById('yearlyYear');
            
            // ì—°ë„ ì˜µì…˜ ìƒì„±
            const currentYear = new Date().getFullYear();
            const years = [...new Set(entries.map(entry => new Date(entry.date).getFullYear()))];
            if (years.length === 0) years.push(currentYear);
            
            yearSelect.innerHTML = years.sort((a, b) => b - a).map(year => 
                `<option value="${year}" ${year === currentYear ? 'selected' : ''}>${year}ë…„</option>`
            ).join('');
            
            updateYearlyView();
        }

        // ì—°ë„ë³„ ë·° ì—…ë°ì´íŠ¸
        function updateYearlyView() {
            const year = parseInt(document.getElementById('yearlyYear').value);
            
            const yearlyEntries = entries.filter(entry => {
                return new Date(entry.date).getFullYear() === year;
            });
            
            // ì—°ë„ë³„ ìš”ì•½ ê³„ì‚°
            const summary = {
                income: yearlyEntries.filter(e => e.type === 'income').reduce((sum, e) => sum + e.amount, 0),
                savings: yearlyEntries.filter(e => e.type === 'savings').reduce((sum, e) => sum + e.amount, 0),
                expense: yearlyEntries.filter(e => e.type === 'expense').reduce((sum, e) => sum + e.amount, 0)
            };
            
            summary.net = summary.income - summary.savings - summary.expense;
            
            // ìš”ì•½ í‘œì‹œ
            document.getElementById('yearlyIncome').textContent = summary.income.toLocaleString() + 'ì›';
            document.getElementById('yearlySavings').textContent = summary.savings.toLocaleString() + 'ì›';
            document.getElementById('yearlyExpense').textContent = summary.expense.toLocaleString() + 'ì›';
            document.getElementById('yearlyNet').textContent = summary.net.toLocaleString() + 'ì›';
            
            // ì›”ë³„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸
            updateYearlyChart(year, yearlyEntries);
            
            // ì¹´í…Œê³ ë¦¬ë³„ ì—°ê°„ ë¶„ì„ ì—…ë°ì´íŠ¸
            updateYearlyCategoryAnalysis(yearlyEntries);
        }

        // ì—°ë„ë³„ ì°¨íŠ¸ ì—…ë°ì´íŠ¸ (ê°„ë‹¨í•œ ë°” ì°¨íŠ¸)
        function updateYearlyChart(year, yearlyEntries) {
            const canvas = document.getElementById('yearlyChart');
            const ctx = canvas.getContext('2d');
            
            // ìº”ë²„ìŠ¤ í¬ê¸° ì„¤ì •
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // ì›”ë³„ ë°ì´í„° ê³„ì‚°
            const monthlyData = Array.from({length: 12}, (_, i) => {
                const month = i + 1;
                const monthEntries = yearlyEntries.filter(entry => {
                    return new Date(entry.date).getMonth() + 1 === month;
                });
                
                return {
                    month: month,
                    income: monthEntries.filter(e => e.type === 'income').reduce((sum, e) => sum + e.amount, 0),
                    savings: monthEntries.filter(e => e.type === 'savings').reduce((sum, e) => sum + e.amount, 0),
                    expense: monthEntries.filter(e => e.type === 'expense').reduce((sum, e) => sum + e.amount, 0)
                };
            });
            
            // ì°¨íŠ¸ ê·¸ë¦¬ê¸°
            const maxValue = Math.max(...monthlyData.flatMap(d => [d.income, d.savings, d.expense]));
            if (maxValue === 0) {
                ctx.fillStyle = '#6b7280';
                ctx.font = '16px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤', canvas.width / 2, canvas.height / 2);
                return;
            }
            
            const barWidth = canvas.width / 12;
            const chartHeight = canvas.height - 60;
            
            monthlyData.forEach((data, index) => {
                const x = index * barWidth;
                const incomeHeight = (data.income / maxValue) * chartHeight;
                const savingsHeight = (data.savings / maxValue) * chartHeight;
                const expenseHeight = (data.expense / maxValue) * chartHeight;
                
                // ìˆ˜ì… (ë…¹ìƒ‰)
                ctx.fillStyle = '#10b981';
                ctx.fillRect(x + 5, canvas.height - 40 - incomeHeight, barWidth / 3 - 2, incomeHeight);
                
                // ì €ì¶• (íŒŒë€ìƒ‰)
                ctx.fillStyle = '#3b82f6';
                ctx.fillRect(x + barWidth / 3 + 3, canvas.height - 40 - savingsHeight, barWidth / 3 - 2, savingsHeight);
                
                // ì§€ì¶œ (ë¹¨ê°„ìƒ‰)
                ctx.fillStyle = '#ef4444';
                ctx.fillRect(x + (barWidth / 3) * 2 + 1, canvas.height - 40 - expenseHeight, barWidth / 3 - 2, expenseHeight);
                
                // ì›” ë¼ë²¨
                ctx.fillStyle = '#374151';
                ctx.font = '12px sans-serif';
                ctx.textAlign = 'center';
                ctx.fillText(`${data.month}ì›”`, x + barWidth / 2, canvas.height - 10);
            });
            
            // ë²”ë¡€
            ctx.fillStyle = '#10b981';
            ctx.fillRect(10, 10, 15, 15);
            ctx.fillStyle = '#374151';
            ctx.font = '12px sans-serif';
            ctx.textAlign = 'left';
            ctx.fillText('ìˆ˜ì…', 30, 22);
            
            ctx.fillStyle = '#3b82f6';
            ctx.fillRect(80, 10, 15, 15);
            ctx.fillText('ì €ì¶•', 100, 22);
            
            ctx.fillStyle = '#ef4444';
            ctx.fillRect(150, 10, 15, 15);
            ctx.fillText('ì§€ì¶œ', 170, 22);
        }

        // ì—°ê°„ ì¹´í…Œê³ ë¦¬ ë¶„ì„ ì—…ë°ì´íŠ¸
        function updateYearlyCategoryAnalysis(yearlyEntries) {
            const types = ['income', 'savings', 'expense'];
            
            types.forEach(type => {
                const container = document.getElementById(`yearly${type.charAt(0).toUpperCase() + type.slice(1)}Analysis`);
                const typeEntries = yearlyEntries.filter(e => e.type === type);
                
                if (typeEntries.length === 0) {
                    container.innerHTML = '<p class="text-gray-500 text-sm">ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</p>';
                    return;
                }
                
                // ì¹´í…Œê³ ë¦¬ë³„ í•©ê³„ ê³„ì‚°
                const categoryTotals = {};
                typeEntries.forEach(entry => {
                    categoryTotals[entry.category] = (categoryTotals[entry.category] || 0) + entry.amount;
                });
                
                const total = Object.values(categoryTotals).reduce((sum, amount) => sum + amount, 0);
                
                // ì •ë ¬ (ê¸ˆì•¡ ìˆœ)
                const sortedCategories = Object.entries(categoryTotals)
                    .sort(([,a], [,b]) => b - a);
                
                container.innerHTML = sortedCategories.map(([category, amount]) => {
                    const percentage = total > 0 ? (amount / total * 100).toFixed(1) : 0;
                    return `
                        <div class="space-y-1">
                            <div class="flex justify-between items-center">
                                <span class="text-sm text-gray-700">${category}</span>
                                <span class="text-sm font-medium">${amount.toLocaleString()}ì›</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-${type === 'income' ? 'green' : type === 'savings' ? 'blue' : 'red'}-500 h-2 rounded-full" style="width: ${percentage}%"></div>
                            </div>
                            <div class="text-xs text-gray-500">${percentage}%</div>
                        </div>
                    `;
                }).join('');
            });
        }

        // ìì‚° í¼ í‘œì‹œ/ìˆ¨ê¹€
        function showAssetForm() {
            document.getElementById('assetForm').style.display = 'block';
            updateAssetCategories();
        }

        function hideAssetForm() {
            document.getElementById('assetForm').style.display = 'none';
            document.getElementById('assetEntryForm').reset();
        }

        // ìì‚° ì¹´í…Œê³ ë¦¬ ì—…ë°ì´íŠ¸
        function updateAssetCategories() {
            const type = document.getElementById('assetType').value;
            const categorySelect = document.getElementById('assetCategory');
            
            categorySelect.innerHTML = '<option value="">ì¹´í…Œê³ ë¦¬ ì„ íƒ</option>';
            
            if (type && assetCategories[type]) {
                assetCategories[type].forEach(category => {
                    const option = document.createElement('option');
                    option.value = category;
                    option.textContent = category;
                    categorySelect.appendChild(option);
                });
            }
        }

        // ìì‚° ì¶”ê°€
        function addAsset(e) {
            e.preventDefault();
            
            const asset = {
                id: Date.now(),
                type: document.getElementById('assetType').value,
                category: document.getElementById('assetCategory').value,
                name: document.getElementById('assetName').value,
                amount: parseInt(document.getElementById('assetAmount').value),
                memo: document.getElementById('assetMemo').value,
                date: new Date().toISOString().split('T')[0]
            };
            
            assets.push(asset);
            localStorage.setItem('assets', JSON.stringify(assets));
            
            hideAssetForm();
            updateAssetsView();
            
            alert('ìì‚°ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ’');
        }

        // ìì‚° ë·° ì—…ë°ì´íŠ¸
        function updateAssetsView() {
            const assetsList = assets.filter(a => a.type === 'asset');
            const liabilitiesList = assets.filter(a => a.type === 'liability');
            
            const totalAssets = assetsList.reduce((sum, a) => sum + a.amount, 0);
            const totalLiabilities = liabilitiesList.reduce((sum, a) => sum + a.amount, 0);
            const netWorth = totalAssets - totalLiabilities;
            
            // ìš”ì•½ ì—…ë°ì´íŠ¸
            document.getElementById('totalAssets').textContent = totalAssets.toLocaleString() + 'ì›';
            document.getElementById('totalLiabilities').textContent = totalLiabilities.toLocaleString() + 'ì›';
            document.getElementById('netWorth').textContent = netWorth.toLocaleString() + 'ì›';
            
            // ìì‚° ëª©ë¡ ì—…ë°ì´íŠ¸
            updateAssetList('assetsList', assetsList, 'asset');
            updateAssetList('liabilitiesList', liabilitiesList, 'liability');
        }

        // ìì‚° ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateAssetList(containerId, list, type) {
            const container = document.getElementById(containerId);
            
            if (list.length === 0) {
                container.innerHTML = `<p class="text-gray-500 text-sm">${type === 'asset' ? 'ìì‚°' : 'ë¶€ì±„'}ì´ ì—†ìŠµë‹ˆë‹¤.</p>`;
                return;
            }
            
            container.innerHTML = list.map(item => `
                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors">
                    <div class="flex-1">
                        <div class="flex items-center space-x-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${type === 'asset' ? 'text-green-600 bg-green-50' : 'text-red-600 bg-red-50'}">
                                ${item.category}
                            </span>
                        </div>
                        <p class="font-medium text-gray-800 mt-1">${item.name}</p>
                        <p class="text-sm text-gray-600">${item.memo || 'ë©”ëª¨ ì—†ìŒ'}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-semibold ${type === 'asset' ? 'text-green-600' : 'text-red-600'}">
                            ${item.amount.toLocaleString()}ì›
                        </p>
                        <p class="text-xs text-gray-500">${item.date}</p>
                    </div>
                    <button onclick="deleteAsset(${item.id})" class="ml-3 text-red-500 hover:text-red-700 transition-colors">
                        ğŸ—‘ï¸
                    </button>
                </div>
            `).join('');
        }

        // ìì‚° ì‚­ì œ
        function deleteAsset(id) {
            if (confirm('ì´ í•­ëª©ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                assets = assets.filter(asset => asset.id !== id);
                localStorage.setItem('assets', JSON.stringify(assets));
                updateAssetsView();
            }
        }

        // ì„¤ì • ë·° ì´ˆê¸°í™”
        function initSettingsView() {
            // ê¸°ë³¸ ì„¤ì • ë¡œë“œ
            document.getElementById('startDate').value = settings.startDate;
            document.getElementById('currency').value = settings.currency;
            
            // ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì—…ë°ì´íŠ¸
            updateCategoryLists();
            
            // ì˜ˆì‚° ì„¤ì • ì—…ë°ì´íŠ¸
            updateBudgetSettings();
        }

        // ì¹´í…Œê³ ë¦¬ ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateCategoryLists() {
            const types = ['income', 'savings', 'expense'];
            
            types.forEach(type => {
                const container = document.getElementById(`${type}Categories`);
                const typeCategories = categories[type] || [];
                
                container.innerHTML = typeCategories.map(category => `
                    <div class="flex items-center justify-between p-2 border border-gray-200 rounded-lg">
                        <span class="text-sm">${category}</span>
                        <button onclick="deleteCategory('${type}', '${category}')" class="text-red-500 hover:text-red-700 text-sm">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                `).join('');
            });
        }

        // ì¹´í…Œê³ ë¦¬ ì¶”ê°€
        function addCategory(type) {
            const input = document.getElementById(`new${type.charAt(0).toUpperCase() + type.slice(1)}Category`);
            const newCategory = input.value.trim();
            
            if (!newCategory) {
                alert('ì¹´í…Œê³ ë¦¬ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if (categories[type].includes(newCategory)) {
                alert('ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ì¹´í…Œê³ ë¦¬ì…ë‹ˆë‹¤.');
                return;
            }
            
            categories[type].push(newCategory);
            localStorage.setItem('categories', JSON.stringify(categories));
            
            input.value = '';
            updateCategoryLists();
        }

        // ì¹´í…Œê³ ë¦¬ ì‚­ì œ
        function deleteCategory(type, category) {
            if (confirm(`'${category}' ì¹´í…Œê³ ë¦¬ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                categories[type] = categories[type].filter(c => c !== category);
                localStorage.setItem('categories', JSON.stringify(categories));
                updateCategoryLists();
            }
        }

        // ê¸°ë³¸ ì„¤ì • ì €ì¥
        function saveBasicSettings() {
            settings.startDate = document.getElementById('startDate').value;
            settings.currency = document.getElementById('currency').value;
            
            localStorage.setItem('settings', JSON.stringify(settings));
            alert('ì„¤ì •ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤! âœ…');
        }

        // ì˜ˆì‚° ì„¤ì • ì—…ë°ì´íŠ¸
        function updateBudgetSettings() {
            const container = document.getElementById('budgetSettings');
            const currentMonth = new Date().toISOString().slice(0, 7);
            
            if (!budgetGoals[currentMonth]) {
                container.innerHTML = '<p class="text-gray-500">ì„¤ì •ëœ ì˜ˆì‚° ëª©í‘œê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            const goals = budgetGoals[currentMonth];
            const typeNames = {
                income: 'ìˆ˜ì…',
                savings: 'ì €ì¶•',
                expense: 'ì§€ì¶œ'
            };
            
            container.innerHTML = Object.entries(goals).map(([type, amount]) => `
                <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                    <span class="text-sm font-medium">${typeNames[type]} ëª©í‘œ</span>
                    <div class="flex items-center space-x-2">
                        <span class="text-sm">${amount.toLocaleString()}ì›</span>
                        <button onclick="deleteBudgetGoal('${type}')" class="text-red-500 hover:text-red-700 text-sm">
                            ğŸ—‘ï¸
                        </button>
                    </div>
                </div>
            `).join('');
        }

        // ì˜ˆì‚° ëª©í‘œ ì¶”ê°€
        function addBudgetGoal() {
            const type = prompt('ì˜ˆì‚° ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”:\n1. income (ìˆ˜ì…)\n2. savings (ì €ì¶•)\n3. expense (ì§€ì¶œ)');
            if (!type || !['income', 'savings', 'expense'].includes(type)) {
                alert('ì˜¬ë°”ë¥¸ ìœ í˜•ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const amount = prompt('ëª©í‘œ ê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš” (ì›):');
            if (!amount || isNaN(amount) || parseInt(amount) <= 0) {
                alert('ì˜¬ë°”ë¥¸ ê¸ˆì•¡ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const currentMonth = new Date().toISOString().slice(0, 7);
            if (!budgetGoals[currentMonth]) {
                budgetGoals[currentMonth] = {};
            }
            
            budgetGoals[currentMonth][type] = parseInt(amount);
            localStorage.setItem('budgetGoals', JSON.stringify(budgetGoals));
            
            updateBudgetSettings();
            alert('ì˜ˆì‚° ëª©í‘œê°€ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ¯');
        }

        // ì˜ˆì‚° ëª©í‘œ ì‚­ì œ
        function deleteBudgetGoal(type) {
            const currentMonth = new Date().toISOString().slice(0, 7);
            if (budgetGoals[currentMonth] && budgetGoals[currentMonth][type]) {
                delete budgetGoals[currentMonth][type];
                localStorage.setItem('budgetGoals', JSON.stringify(budgetGoals));
                updateBudgetSettings();
            }
        }

        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportData() {
            const data = {
                entries,
                assets,
                categories,
                budgetGoals,
                settings,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ê°€ê³„ë¶€_ë°±ì—…_${new Date().toISOString().slice(0, 10)}.json`;
            a.click();
            URL.revokeObjectURL(url);
        }

        // ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        function importData() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.json';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const data = JSON.parse(e.target.result);
                        
                        if (confirm('ê¸°ì¡´ ë°ì´í„°ë¥¼ ëª¨ë‘ ë®ì–´ì“°ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                            entries = data.entries || [];
                            assets = data.assets || [];
                            categories = data.categories || categories;
                            budgetGoals = data.budgetGoals || {};
                            settings = data.settings || settings;
                            
                            // ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                            localStorage.setItem('entries', JSON.stringify(entries));
                            localStorage.setItem('assets', JSON.stringify(assets));
                            localStorage.setItem('categories', JSON.stringify(categories));
                            localStorage.setItem('budgetGoals', JSON.stringify(budgetGoals));
                            localStorage.setItem('settings', JSON.stringify(settings));
                            
                            // ë·° ì—…ë°ì´íŠ¸
                            updateRecentEntries();
                            updateAssetsView();
                            initSettingsView();
                            
                            alert('ë°ì´í„°ë¥¼ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤! ğŸ“¥');
                        }
                    } catch (error) {
                        alert('íŒŒì¼ì„ ì½ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
                    }
                };
                reader.readAsText(file);
            };
            input.click();
        }

        // ë°ì´í„° ì´ˆê¸°í™”
        function resetData() {
            if (confirm('ì •ë§ë¡œ ëª¨ë“  ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                if (confirm('í•œ ë²ˆ ë” í™•ì¸í•©ë‹ˆë‹¤. ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë©ë‹ˆë‹¤.')) {
                    localStorage.clear();
                    location.reload();
                }
            }
        }

        // ìì‚° ìœ í˜• ë³€ê²½ ì‹œ ì¹´í…Œê³ ë¦¬ ì—…ë°ì´íŠ¸
        document.getElementById('assetType').addEventListener('change', updateAssetCategories);

        // ê³µìœ  ë·° ì´ˆê¸°í™”
        function initShareView() {
            updateShareStatus();
            updateActiveSharesList();
        }

        // ê³µìœ  ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateShareStatus() {
            const container = document.getElementById('shareStatus');
            
            if (activeShares.length === 0 && connectedShares.length === 0) {
                container.innerHTML = '<p class="text-gray-500">í˜„ì¬ í™œì„±í™”ëœ ê³µìœ ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let html = '';
            
            if (activeShares.length > 0) {
                html += `<div class="p-3 bg-blue-50 border border-blue-200 rounded-lg">
                    <p class="text-blue-700 font-medium">ğŸ“¤ ë‚´ê°€ ê³µìœ í•œ ê°€ê³„ë¶€: ${activeShares.length}ê°œ</p>
                </div>`;
            }
            
            if (connectedShares.length > 0) {
                html += `<div class="p-3 bg-green-50 border border-green-200 rounded-lg">
                    <p class="text-green-700 font-medium">ğŸ“¥ ì—°ê²°ëœ ê°€ê³„ë¶€: ${connectedShares.length}ê°œ</p>
                </div>`;
            }
            
            container.innerHTML = html;
        }

        // ê³µìœ  ë§í¬ ìƒì„±
        function generateShareLink() {
            const shareType = document.getElementById('shareType').value;
            const shareEntries = document.getElementById('shareEntries').checked;
            const shareAssets = document.getElementById('shareAssets').checked;
            const shareBudgets = document.getElementById('shareBudgets').checked;
            const shareExpiry = document.getElementById('shareExpiry').value;
            
            if (!shareEntries && !shareAssets && !shareBudgets) {
                alert('ê³µìœ í•  ë°ì´í„°ë¥¼ ìµœì†Œ í•˜ë‚˜ëŠ” ì„ íƒí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ê³µìœ  ì½”ë“œ ìƒì„± (6ìë¦¬ ëœë¤)
            const shareCode = Math.random().toString(36).substring(2, 8).toUpperCase();
            
            // ê³µìœ  ë°ì´í„° ì¤€ë¹„
            const sharedData = {
                entries: shareEntries ? entries : [],
                assets: shareAssets ? assets : [],
                budgetGoals: shareBudgets ? budgetGoals : {},
                categories: categories,
                settings: settings
            };
            
            // ë§Œë£Œì¼ ê³„ì‚°
            let expiryDate = null;
            if (shareExpiry) {
                expiryDate = new Date();
                expiryDate.setDate(expiryDate.getDate() + parseInt(shareExpiry));
            }
            
            // ê³µìœ  ì •ë³´ ì €ì¥
            const shareInfo = {
                id: Date.now(),
                code: shareCode,
                type: shareType,
                data: sharedData,
                createdAt: new Date().toISOString(),
                expiryDate: expiryDate ? expiryDate.toISOString() : null,
                accessCount: 0
            };
            
            activeShares.push(shareInfo);
            shareData[shareCode] = shareInfo;
            
            localStorage.setItem('activeShares', JSON.stringify(activeShares));
            localStorage.setItem('shareData', JSON.stringify(shareData));
            
            // ê³µìœ  ë§í¬ í‘œì‹œ
            const shareUrl = `${window.location.origin}${window.location.pathname}?share=${shareCode}`;
            document.getElementById('shareUrl').value = shareUrl;
            document.getElementById('shareCode').value = shareCode;
            document.getElementById('generatedLink').style.display = 'block';
            
            updateActiveSharesList();
            updateShareStatus();
            
            alert('ê³µìœ  ë§í¬ê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ‰');
        }

        // ê³µìœ  ë§í¬ ë³µì‚¬
        function copyShareLink() {
            const shareUrl = document.getElementById('shareUrl');
            shareUrl.select();
            document.execCommand('copy');
            alert('ê³µìœ  ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“‹');
        }

        // ê³µìœ  ì½”ë“œ ë³µì‚¬
        function copyShareCode() {
            const shareCode = document.getElementById('shareCode');
            shareCode.select();
            document.execCommand('copy');
            alert('ê³µìœ  ì½”ë“œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ğŸ“‹');
        }

        // ê³µìœ  ì½”ë“œë¡œ ì—°ê²°
        function connectWithCode() {
            const inputCode = document.getElementById('inputShareCode').value.trim().toUpperCase();
            
            if (!inputCode) {
                alert('ê³µìœ  ì½”ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            // ì‹œë®¬ë ˆì´ì…˜: ì‹¤ì œë¡œëŠ” ì„œë²„ì—ì„œ í™•ì¸í•´ì•¼ í•¨
            // ì—¬ê¸°ì„œëŠ” ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì˜ shareDataì—ì„œ í™•ì¸
            if (!shareData[inputCode]) {
                alert('ìœ íš¨í•˜ì§€ ì•Šì€ ê³µìœ  ì½”ë“œì…ë‹ˆë‹¤.');
                return;
            }
            
            const sharedInfo = shareData[inputCode];
            
            // ë§Œë£Œ í™•ì¸
            if (sharedInfo.expiryDate && new Date() > new Date(sharedInfo.expiryDate)) {
                alert('ë§Œë£Œëœ ê³µìœ  ì½”ë“œì…ë‹ˆë‹¤.');
                return;
            }
            
            // ì´ë¯¸ ì—°ê²°ëœ ì½”ë“œì¸ì§€ í™•ì¸
            if (connectedShares.some(share => share.code === inputCode)) {
                alert('ì´ë¯¸ ì—°ê²°ëœ ê°€ê³„ë¶€ì…ë‹ˆë‹¤.');
                return;
            }
            
            // ì—°ê²° ì •ë³´ ì €ì¥
            const connectionInfo = {
                code: inputCode,
                type: sharedInfo.type,
                connectedAt: new Date().toISOString(),
                ownerName: `ì‚¬ìš©ì_${inputCode.substring(0, 3)}`
            };
            
            connectedShares.push(connectionInfo);
            localStorage.setItem('connectedShares', JSON.stringify(connectedShares));
            
            // ì ‘ê·¼ íšŸìˆ˜ ì¦ê°€
            sharedInfo.accessCount++;
            shareData[inputCode] = sharedInfo;
            localStorage.setItem('shareData', JSON.stringify(shareData));
            
            document.getElementById('inputShareCode').value = '';
            updateShareStatus();
            updateActiveSharesList();
            
            alert(`ê°€ê³„ë¶€ì— ì„±ê³µì ìœ¼ë¡œ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤! (${sharedInfo.type === 'view' ? 'ë³´ê¸° ì „ìš©' : 'í¸ì§‘ ê°€ëŠ¥'}) ğŸ‰`);
        }

        // í™œì„± ê³µìœ  ëª©ë¡ ì—…ë°ì´íŠ¸
        function updateActiveSharesList() {
            const container = document.getElementById('activeShares');
            
            if (activeShares.length === 0 && connectedShares.length === 0) {
                container.innerHTML = '<p class="text-gray-500">í™œì„±í™”ëœ ê³µìœ ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
                return;
            }
            
            let html = '';
            
            // ë‚´ê°€ ê³µìœ í•œ ëª©ë¡
            if (activeShares.length > 0) {
                html += '<h4 class="font-medium text-gray-800 mb-3">ğŸ“¤ ë‚´ê°€ ê³µìœ í•œ ê°€ê³„ë¶€</h4>';
                activeShares.forEach(share => {
                    const isExpired = share.expiryDate && new Date() > new Date(share.expiryDate);
                    html += `
                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg ${isExpired ? 'bg-gray-50' : 'bg-white'}">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2">
                                    <span class="px-2 py-1 text-xs font-medium rounded-full ${share.type === 'view' ? 'text-blue-600 bg-blue-50' : 'text-green-600 bg-green-50'}">
                                        ${share.type === 'view' ? 'ë³´ê¸° ì „ìš©' : 'í¸ì§‘ ê°€ëŠ¥'}
                                    </span>
                                    <span class="text-sm font-mono font-medium">${share.code}</span>
                                    ${isExpired ? '<span class="text-xs text-red-500">(ë§Œë£Œë¨)</span>' : ''}
                                </div>
                                <p class="text-xs text-gray-500 mt-1">
                                    ìƒì„±ì¼: ${new Date(share.createdAt).toLocaleDateString()} | 
                                    ì ‘ê·¼ íšŸìˆ˜: ${share.accessCount}íšŒ
                                    ${share.expiryDate ? ` | ë§Œë£Œì¼: ${new Date(share.expiryDate).toLocaleDateString()}` : ''}
                                </p>
                            </div>
                            <button onclick="deleteShare('${share.code}')" class="text-red-500 hover:text-red-700 transition-colors">
                                ğŸ—‘ï¸
                            </button>
                        </div>
                    `;
                });
            }
            
            // ì—°ê²°ëœ ê°€ê³„ë¶€ ëª©ë¡
            if (connectedShares.length > 0) {
                if (activeShares.length > 0) html += '<div class="my-4 border-t border-gray-200"></div>';
                html += '<h4 class="font-medium text-gray-800 mb-3">ğŸ“¥ ì—°ê²°ëœ ê°€ê³„ë¶€</h4>';
                connectedShares.forEach(connection => {
                    html += `
                        <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg bg-white">
                            <div class="flex-1">
                                <div class="flex items-center space-x-2">
                                    <span class="px-2 py-1 text-xs font-medium rounded-full ${connection.type === 'view' ? 'text-blue-600 bg-blue-50' : 'text-green-600 bg-green-50'}">
                                        ${connection.type === 'view' ? 'ë³´ê¸° ì „ìš©' : 'í¸ì§‘ ê°€ëŠ¥'}
                                    </span>
                                    <span class="text-sm font-medium">${connection.ownerName}ì˜ ê°€ê³„ë¶€</span>
                                </div>
                                <p class="text-xs text-gray-500 mt-1">
                                    ì—°ê²°ì¼: ${new Date(connection.connectedAt).toLocaleDateString()} | 
                                    ì½”ë“œ: ${connection.code}
                                </p>
                            </div>
                            <div class="flex space-x-2">
                                <button onclick="viewSharedData('${connection.code}')" class="text-blue-500 hover:text-blue-700 transition-colors text-sm">
                                    ğŸ‘ï¸ ë³´ê¸°
                                </button>
                                <button onclick="disconnectShare('${connection.code}')" class="text-red-500 hover:text-red-700 transition-colors">
                                    ğŸ”Œ
                                </button>
                            </div>
                        </div>
                    `;
                });
            }
            
            container.innerHTML = html;
        }

        // ê³µìœ  ì‚­ì œ
        function deleteShare(code) {
            if (confirm('ì´ ê³µìœ ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                activeShares = activeShares.filter(share => share.code !== code);
                delete shareData[code];
                
                localStorage.setItem('activeShares', JSON.stringify(activeShares));
                localStorage.setItem('shareData', JSON.stringify(shareData));
                
                updateActiveSharesList();
                updateShareStatus();
            }
        }

        // ê³µìœ  ì—°ê²° í•´ì œ
        function disconnectShare(code) {
            if (confirm('ì´ ê°€ê³„ë¶€ ì—°ê²°ì„ í•´ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                connectedShares = connectedShares.filter(connection => connection.code !== code);
                localStorage.setItem('connectedShares', JSON.stringify(connectedShares));
                
                updateActiveSharesList();
                updateShareStatus();
            }
        }

        // ê³µìœ ëœ ë°ì´í„° ë³´ê¸°
        function viewSharedData(code) {
            if (!shareData[code]) {
                alert('ê³µìœ  ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const sharedInfo = shareData[code];
            const data = sharedInfo.data;
            
            // ìƒˆ ì°½ì—ì„œ ê³µìœ  ë°ì´í„° í‘œì‹œ (ê°„ë‹¨í•œ ìš”ì•½)
            let summary = `=== ê³µìœ ëœ ê°€ê³„ë¶€ ë°ì´í„° ===\n\n`;
            
            if (data.entries && data.entries.length > 0) {
                const totalIncome = data.entries.filter(e => e.type === 'income').reduce((sum, e) => sum + e.amount, 0);
                const totalSavings = data.entries.filter(e => e.type === 'savings').reduce((sum, e) => sum + e.amount, 0);
                const totalExpense = data.entries.filter(e => e.type === 'expense').reduce((sum, e) => sum + e.amount, 0);
                
                summary += `ğŸ“Š ìˆ˜ì…/ì§€ì¶œ ìš”ì•½:\n`;
                summary += `- ì´ ìˆ˜ì…: ${totalIncome.toLocaleString()}ì›\n`;
                summary += `- ì´ ì €ì¶•: ${totalSavings.toLocaleString()}ì›\n`;
                summary += `- ì´ ì§€ì¶œ: ${totalExpense.toLocaleString()}ì›\n`;
                summary += `- ìˆœ ìì‚° ë³€í™”: ${(totalIncome - totalSavings - totalExpense).toLocaleString()}ì›\n\n`;
            }
            
            if (data.assets && data.assets.length > 0) {
                const totalAssets = data.assets.filter(a => a.type === 'asset').reduce((sum, a) => sum + a.amount, 0);
                const totalLiabilities = data.assets.filter(a => a.type === 'liability').reduce((sum, a) => sum + a.amount, 0);
                
                summary += `ğŸ’ ìì‚° ìš”ì•½:\n`;
                summary += `- ì´ ìì‚°: ${totalAssets.toLocaleString()}ì›\n`;
                summary += `- ì´ ë¶€ì±„: ${totalLiabilities.toLocaleString()}ì›\n`;
                summary += `- ìˆœ ìì‚°: ${(totalAssets - totalLiabilities).toLocaleString()}ì›\n\n`;
            }
            
            summary += `ğŸ“… ë°ì´í„° ìƒì„±ì¼: ${new Date(sharedInfo.createdAt).toLocaleString()}\n`;
            summary += `ğŸ”’ ê¶Œí•œ: ${sharedInfo.type === 'view' ? 'ë³´ê¸° ì „ìš©' : 'í¸ì§‘ ê°€ëŠ¥'}`;
            
            alert(summary);
        }

        // URLì—ì„œ ê³µìœ  ì½”ë“œ í™•ì¸ (í˜ì´ì§€ ë¡œë“œ ì‹œ)
        function checkShareCode() {
            const urlParams = new URLSearchParams(window.location.search);
            const shareCode = urlParams.get('share');
            
            if (shareCode) {
                document.getElementById('inputShareCode').value = shareCode;
                showPage('share');
                
                // ìë™ìœ¼ë¡œ ì—°ê²° ì‹œë„
                setTimeout(() => {
                    if (confirm(`ê³µìœ  ì½”ë“œ "${shareCode}"ë¡œ ê°€ê³„ë¶€ì— ì—°ê²°í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                        connectWithCode();
                    }
                }, 500);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', function() {
            init();
            checkShareCode();
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97ba31a7e2ddaa4a',t:'MTc1NzI4OTkyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
